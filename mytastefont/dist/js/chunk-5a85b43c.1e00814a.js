(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a85b43c"],{3458:function(t,e,s){},"45a1":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-container",[s("el-header",[s("Header",{on:{user:t.getUser}})],1),s("el-main",[s("el-row",{attrs:{id:"summary"}},[s("el-col",{attrs:{span:18,offset:3}},[s("el-row",[s("el-col",{attrs:{span:22}},[s("h1",[t._v(t._s(t.scene.name))])]),s("el-row",[s("el-col",{attrs:{span:22}},[s("p",[t._v(t._s(t.scene.ename))])])],1)],1),s("hr"),s("el-row",[s("a",{attrs:{href:"#summary"}},[t._v("概括")]),s("a",{staticStyle:{"margin-left":"50px"},attrs:{href:"#comment"}},[t._v("评论")]),s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:t.newComment}},[t._v(" 我要评论 ")])],1),s("hr"),s("el-row",[s("img",{attrs:{src:t.scene.main_photo,alt:""}}),s("p",{staticStyle:{"margin-top":"50px"}},[t._v(t._s(t.scene.summary))])]),s("hr"),s("el-row",[s("el-col",{attrs:{span:8}},[s("p",[t._v("电话")]),s("p",[t._v(t._s(t.scene.phone))])]),s("el-col",{attrs:{span:8}},[s("p",[t._v("网址")]),s("el-link",{attrs:{type:"primary",href:t.scene.website}},[t._v(t._s(t.scene.website))])],1),s("el-col",{attrs:{span:8}},[s("p",[t._v("用时参考")]),s("p",[t._v(t._s(t.scene.advice_time))])])],1),s("el-row",{staticStyle:{"margin-top":"20px"}},[s("p",[t._v(t._s(t.scene.address))])]),s("el-row",{staticStyle:{"margin-top":"20px"}},[s("p",[t._v("交通")]),s("p",[t._v(t._s(t.scene.traffic))])]),s("el-row",{staticStyle:{"margin-top":"20px"}},[s("p",[t._v("开放时间")]),s("p",[t._v(t._s(t.scene.open_time))])]),s("el-row",{staticStyle:{"margin-top":"20px"}},[s("p",[t._v("小提示")]),s("p",[t._v(t._s(t.scene.tips))])]),s("el-row",{staticStyle:{"margin-top":"20px","font-size":"10px"}},[s("p",[t._v("最后修改时间"+t._s(t.scene.updated_time))])])],1)],1),s("hr"),s("el-row",{attrs:{id:"comment"}},[s("el-col",{attrs:{span:18,offset:3}},[s("div",{staticClass:"rev-list"},[s("ul",{staticStyle:{"list-style":"none"}},t._l(t.comments,(function(e){return s("li",{key:e.id,staticClass:"rev-item comment-item clearfix"},[s("div",{staticClass:"user"},[s("router-link",{staticClass:"avatar",attrs:{to:"/user/1",target:"_blank"}},[s("img",{attrs:{src:t.mainPhotoSrc(e.user_info.avatar),width:"48",height:"48"}})])],1),s("router-link",{staticClass:"name",attrs:{to:"/user/1",target:"_blank"}},[t._v(" "+t._s(e.user_info.username)+" ")]),s("span",{staticClass:"s-star",class:t.score2Stars(e.score)}),s("p",{staticClass:"rev-txt"},[t._v(" "+t._s(e.content)+" ")]),s("div",{staticClass:"info clearfix"},[s("span",{staticClass:"time"},[t._v(t._s(e.created_time))])])],1)})),0)])])],1),s("el-pagination",{staticStyle:{"text-align":"center","margin-top":"20px","margin-bottom":"40px"},attrs:{background:"",layout:"prev, pager, next","page-size":t.pageSize,total:t.commentsCount},on:{"current-change":t.handleCurrentChange}}),s("el-dialog",{attrs:{title:"发布您的评论-"+t.scene.name+"-酒店",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[s("el-form",{attrs:{model:t.form}},[s("el-form-item",{attrs:{label:"评分","label-width":t.formLabelWidth}},[s("el-rate",{attrs:{colors:t.colors},model:{value:t.form.score,callback:function(e){t.$set(t.form,"score",e)},expression:"form.score"}})],1),s("el-form-item",{attrs:{label:"内容","label-width":t.formLabelWidth}},[s("el-input",{attrs:{type:"textarea",placeholder:"此处发表您的评论"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("确 定")])],1)],1)],1),s("el-footer",[s("Footer")],1)],1)},n=[],o=(s("99af"),s("9898")),i=s("3e61"),r={name:"Scene",data:function(){return{uid:0,id:0,scene:void 0,comments:[],pageSize:10,commentsCount:0,page:1,dialogFormVisible:!1,form:{score:0,content:""},formLabelWidth:"120px",colors:["#99A9BF","#F7BA2A","#FF9900"]}},computed:{mainPhotoSrc:function(){var t=this;return function(e){return"".concat(t.$settings.HOST).concat(e)}},score2Stars:function(){return function(t){var e="s-star0";switch(t){case 1:e="s-star1";break;case 2:e="s-star2";break;case 3:e="s-star3";break;case 4:e="s-star4";break;case 5:e="s-star5";break}return e}}},methods:{getUser:function(t){this.uid=t},getScene:function(t){var e=this;this.$axios({url:"".concat(this.$settings.HOST,"/scene/").concat(t,"/"),method:"GET"}).then((function(t){e.scene=t.data})).catch((function(t){alert(t.response.data)}))},getSceneComments:function(t){var e=this;this.$axios({url:"".concat(this.$settings.HOST,"/scene_comments/").concat(t,"/"),method:"GET",params:{page:this.page,page_size:this.pageSize}}).then((function(t){e.comments=t.data.results,e.commentsCount=t.data.count})).catch((function(t){alert(t.response)}))},handleCurrentChange:function(t){this.page=t,location.href="#comment",this.getSceneComments(this.id)},open:function(){var t=this;this.$confirm("亲，发表评论需要登录哦, 前往登录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$router.push("/login")}))},newComment:function(){this.uid?this.dialogFormVisible=!0:this.open()},onSubmit:function(){var t=this;this.dialogFormVisible=!1,this.$axios({url:"".concat(this.$settings.HOST,"/scene_comment/"),method:"POST",data:{user:this.uid,content:this.form.content,score:this.form.score,scene:this.id}}).then((function(e){t.$message.success("评论发布成功！")})).catch((function(t){alert("啊呀，出错啦！请重试!")})),this.form.score=0,this.form.content="",this.$axios({url:"".concat(this.$settings.HOST,"/user/new_loved_scene/"),method:"POST",data:{user:this.uid,type:2,scene:this.id}}).catch((function(t){alert("啊呀，出错啦！请重试!")}))}},created:function(){this.id=this.$route.params.id,this.getScene(this.id),this.getSceneComments(this.id),this.getUser()},components:{Footer:i["default"],Header:o["default"]}},c=r,l=(s("e3b4"),s("2877")),m=Object(l["a"])(c,a,n,!1,null,"9e48f01a",null);e["default"]=m.exports},e3b4:function(t,e,s){"use strict";var a=s("3458"),n=s.n(a);n.a}}]);
//# sourceMappingURL=chunk-5a85b43c.1e00814a.js.map